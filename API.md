# Реализация API

- POST /api/user/register
- POST /api/user/login
- GET /api/search/{request}
- POST /api/search (request using JSON)
- POST /api/item    (new)
- UPDATE /api/item   (edit)
- DELETE /api/item      (delete)
- GET /api/item/{pictureID}
- GET /api/user/catalog (for specified client)

![image](https://user-images.githubusercontent.com/115189830/232253879-8d464205-aef6-4d7d-aeaf-0aabde897be7.png)

Все общение между клиентом и сервером должно быть зашифровано. Для шифрования использовать идентификатор агента (передаваемый агенту в момент регистрации), одноразовый вектор передается вместе с сообщением на усмотрение создателя.

### Регистрация пользователя
```
  POST 
  /api/user/register
```
Хэндлер доступен незарегистрированым пользователям. Login должен быть уникальным.
Данные передаются в виде JSON:

```
 {
  login: "setByUser",
  password: "setByUser"
 }
```
Возможные варианты ответов:

- `201` - успех, регистрация прошла успешно, агент остается залогинен на срок соответствующий параметрам
- `409` - пользователь с таким логином уже существует и пароль не совпадает
- `500` - внутренняя ошибка сервиса

### Авторизация пользователя

 ```
POST
/api/user/login
 ```

Хэндлер доступен незарегистрированым пользователям. Данные передаются в виде JSON:
```
 {
  login: "setByUser",
  password: "setByUser"
 }
 ```
Возможные варианты ответов:

- `200` - успех, регистрация прошла успешно, агент остается залогинен на срок соответствующий параметрам
- `401` - пара логин-пароль неверная
- `500` - внутренняя ошибка сервиса

### Быстрый поиск

```GET 
/api/search/{request}
```
Хэндлер доступен только авторизованному пользователю. Запрос в адресе:

request - возвращает все карточки в которых данная последовательность символов встречается в названии или в значении любого из параметров.

Ответ в формате массива JSON
```
[{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemcover:[[]byte],
}]
```
Возможные варианты ответов:

- `200` - успех, передан список найденных карточек
- `401` - ошибка авторизации
- `404` - не найдено ни одного ответа
- `500` - внутренняя ошибка сервиса


### Поиск с использованием тегов
```
POST 
/api/search (request using JSON)
```
Хэндлер доступен только авторизованному пользователю. Запрос в JSON:
```
{
	request:"word", // хотя бы одно совпадение последовательности символов в названии или в значении хотя бы одного параметра
	itemTagsReq:[tag1 tag2], // && у карточки должны быть указаны оба тега
}
```
Ответ в формате массива JSON
```
[{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemcover:[[]byte],
}]
```

Возможные варианты ответов:

- `200` - успех, передан список найденных карточек
- `401` - ошибка авторизации
- `404` - не найдено ни одного ответа
- `500` - внутренняя ошибка сервиса

### Добавить новую карточку товара
```
POST
/api/item
```
Хэндлер доступен только авторизованному пользователю. Запрос в JSON:
```
{
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemPicturesOriginal:[[]byte],
}
```
Ответ в формате JSON
```
{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemcover:[[]byte],
}
```
Возможные варианты ответов:

- `201` - успех, создана новая карточка
- `401` - ошибка авторизации
- `500` - внутренняя ошибка сервиса
	
### Изменить карточку товара
```
UPDATE
/api/item
```
Хэндлер доступен только авторизованному пользователю. Запрос в JSON:
```
{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemPicturesOriginal:[[]byte],
}
```
Ответ в формате массива JSON
```
[{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemcover:[[]byte],
}]
```
Возможные варианты ответов:
- `200` - успех, карточка обновлена
- `401` - ошибка авторизации
- `500` - внутренняя ошибка сервиса
	
### Удалить карточку товара
```
DELETE
/api/item
```
Хэндлер доступен только авторизованному пользователю. Запрос в JSON:
```
{
	itemid:"00001",
}
```
Ответ в формате массива JSON
```
{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	Itemcover:[[]byte],
}
```
Возможные варианты ответов:
- `200` - успех, карточка удалена
- `401` - ошибка авторизации
- `500` - внутренняя ошибка сервиса

### Получить картинку нормального размера
```
GET 
/api/item/{pictureID}
```
Хэндлер доступен только авторизованному пользователю.

Возможные варианты ответов:

- `200` - успех, передана картинка
- `401` - ошибка авторизации
- `404` - нет такой картинки
- `500` - внутренняя ошибка сервиса


### Передать клиенту всю его информацию
```
GET 
/api/user/catalog
```
Хэндлер доступен только авторизованному пользователю.

Ответ в формате массива JSON
```
[{
	itemid:"00001",
	itemame: "itemname",
	itemtags: [Tag1 Tag2],
	itemparameters:[
	[parameter1]:"001",
	[parameter2]:"value of parameter 2",
	],
	itemcover:[[]byte],
	itempicture:[[]byte]
}]
```
Возможные варианты ответов:

- `200` - успех, карточка удалена
- `401` - ошибка авторизации
- `500` - внутренняя ошибка сервиса
